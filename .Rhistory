arrange(RMSE) |>
kable(digits = 4)
arima_fit |>
select(arima_enso_log_co2     ) |>
report()
arima_fit |>
select(arima_enso_log_co2) |>
report()
arima_second_fit |>
select(arima_enso_log_co2) |>
report()
arima_second_fit |>
select(arima_lag_ten_nino_log) |>
report()
arima_second_fit |>
select(arima_enso_smooth_log) |>
report()
arima_second_fit |>
tidy() |>
group_by(.model, term) |>
summarize(across(.cols = c(estimate:`p.value`), .fns = mean)) |>
filter(.model == "arima_enso_smooth_log")
arima_second_fit |>
select(arima_enso_log_co2) |>
report()
arima_second_fit |>
tidy() |>
group_by(.model, term) |>
summarize(across(.cols = c(estimate:`p.value`), .fns = mean)) |>
filter(.model == "arima_enso_log_co2")
arima_fit |>
select(arima_enso_log_co2) |>
ggtime::gg_tsresiduals(plot_type = 'partial')
arima_second_fit |>
select(arima_enso_log_co2) |>
ggtime::gg_tsresiduals(plot_type = 'partial')
arima_second_fit |>
select(arima_enso_log_co2) |>
ggtime::gg_tsresiduals(plot_type = 'partial')
arima_second_fit |>
select(arima_enso_smooth_log) |>
ggtime::gg_tsresiduals(plot_type = 'partial')
arima_second_fc |>
accuracy(arima_valid) |>
select(.model, ME:MAPE) |>
arrange(RMSE) |>
kable(digits = 4)
arima_second_fit |>
select(arima_auto) |>
ggtime::gg_tsresiduals(plot_type = 'partial')
arima_fit |>
select(arima_enso) |>
ggtime::gg_tsresiduals(plot_type = 'partial')
arima_second_fc |>
accuracy(arima_valid) |>
select(.model, ME:MAPE) |>
arrange(RMSE) |>
kable(digits = 4)
arima_second_fit |>
select(arima_enso_log_co2) |>
ggtime::gg_tsresiduals(plot_type = 'partial')
arima_second_fit |>
select(arima_lag_ten_nino_log) |>
ggtime::gg_tsresiduals(plot_type = 'partial')
arima_second_fit |>
select(arima_enso_smooth_log) |>
ggtime::gg_tsresiduals(plot_type = 'partial')
arima_fit |>
select(arima_enso) |>
ggtime::gg_tsresiduals(plot_type = 'partial')
arima_fit |>
select(arima_lag_ten_nino) |>
ggtime::gg_tsresiduals(plot_type = 'partial')
arima_fit |>
tidy() |>
group_by(.model, term) |>
summarize(across(.cols = c(estimate:`p.value`), .fns = mean)) |>
filter(.model == "arima_lag_ten_nino")
arima_third_fit <- arima_trn |>
model(
arima_lag_ten_nino_log = ARIMA(log(actual_temp) ~ 0 + co2_lag10 + el_nino + la_nina + pdq(3, 1, 0) + PDQ(2, 1, 2)),
arima_enso_log_co2 = ARIMA(log(actual_temp) ~ ENSO + co2_ppm + pdq(1, 1, 3) + PDQ(0, 1, 1)),
arima_enso_smooth_log = ARIMA(log(actual_temp) ~ enso_smooth + co2_ppm),
arima_enso_30 = ARIMA(actual_temp ~ co2_lag30 + el_nino + la_nina + pdq(4, 1, 0) + PDQ(2, 1, 2)),
arima_lag_ten_nino = ARIMA(actual_temp ~ co2_lag10 + el_nino + la_nina + pdq(3, 1, 0) + PDQ(2, 1, 0))
)
arima_third_fc <- arima_third_fit |>
forecast(new_data = arima_valid)
arima_third_fc |>
accuracy(arima_valid) |>
select(.model, ME:MAPE) |>
arrange(RMSE) |>
kable(digits = 4)
arima_second_fit |>
select(arima_enso_log_co2) |>
report(arima_enso_smooth_log)
arima_third_fit |>
select(arima_enso_smooth_log) |>
report()
arima_fit |>
tidy() |>
group_by(.model, term) |>
summarize(across(.cols = c(estimate:`p.value`), .fns = mean)) |>
filter(.model == "ARIMA(0,0,3)(0,1,1")
filter(.model == "arima_enso_smooth_log"
arima_fit |>
arima_fit |>
tidy() |>
group_by(.model, term) |>
summarize(across(.cols = c(estimate:`p.value`), .fns = mean)) |>
filter(.model == "arima_enso_smooth_log")
arima_third_fit |>
tidy() |>
group_by(.model, term) |>
summarize(across(.cols = c(estimate:`p.value`), .fns = mean)) |>
filter(.model == "arima_enso_smooth_log")
arima_third_fit |>
select(arima_enso_smooth_log) |>
ggtime::gg_tsresiduals(plot_type = 'partial')
arima_third_fc |>
accuracy(arima_valid) |>
select(.model, ME:MAPE) |>
arrange(RMSE) |>
kable(digits = 4)
arima_third_fit |>
select(arima_enso_log_co2) |>
ggtime::gg_tsresiduals(plot_type = 'partial')
arima_third_fit |>
select(arima_lag_ten_nino) |>
ggtime::gg_tsresiduals(plot_type = 'partial')
arima_data <- predictor_modeling |>
filter(year(Date) > 1957)
dim(arima_data)
arima_cv <- arima_data |>
stretch_tsibble(.init = 513, .step = 60)
tail(arima_cv)
tail(arima_cv$.id)
arima_cv <- arima_data |>
stretch_tsibble(.init = 573, .step = 60)
arima_cv$.id
tail(arima_cv$.id)
arima_trn <- arima_cv |>
group_by(.id) |>
slice(1:(n() - 60)) |>
ungroup()
arima_valid <- arima_cv |>
group_by(.id) |>
slice_tail(n = 60) |>
ungroup()
arima_cv <- arima_data |>
stretch_tsibble(.init = 573, .step = 60)
arima_trn <- arima_cv |>
group_by(.id) |>
slice(1:(n() - 60)) |>
ungroup()
arima_valid <- arima_cv |>
group_by(.id) |>
slice_tail(n = 60) |>
ungroup()
arima_cv_fit <- arima_trn |>
model(
arima_auto = ARIMA(actual_temp ~ co2_ppm + PDQ(D = 1)),
arima_all = ARIMA(actual_temp ~ co2_ppm + ch4_ppb + n2o_ppb + TSI + el_nino + la_nina + PDQ(D = 1)),
arima_lag_ten = ARIMA(actual_temp ~ co2_lag10 + PDQ(D = 1)),
arima_lag_ten_nino = ARIMA(actual_temp ~ co2_lag10 + el_nino + la_nina + PDQ(D = 1)),
arima_enso = ARIMA(log(actual_temp) ~ ENSO + PDQ(D = 1)),
arima_enso_smooth = ARIMA(actual_temp ~ enso_smooth + PDQ(D = 1)),
arima_enso_log_co2 = ARIMA(log(actual_temp) ~ ENSO + co2_ppm + PDQ(D = 1)),
arima_enso_smooth_log = ARIMA(log(actual_temp) ~ enso_smooth + co2_ppm + PDQ(D = 1))
)
arima_cv_fc <- arima_cv_fit |>
forecast(new_data = arima_valid)
arima_cv_fc |>
accuracy(arima_valid) |>
select(.model, ME:MAPE) |>
arrange(RMSE) |>
kable(digits = 4)
arima_cv_fc |>
accuracy(arima_valid) |>
select(.model, ME:MAPE) |>
summarize(across(.cols = c(ME:MAPE), .fns = mean)) |>
arrange(RMSE) |>
kable(digits = 4)
arima_cv_fc |>
accuracy(arima_valid) |>
select(.model, ME:MAPE) |>
group_by(.model) |>
summarize(across(.cols = c(ME:MAPE), .fns = mean)) |>
arrange(RMSE) |>
kable(digits = 4)
arima_cv_fit |>
tidy() |>
group_by(.model, term) |>
summarize(across(.cols = c(estimate:`p.value`), .fns = mean)) |>
filter(.model == "arima_enso_smooth_log")
arima_cv_fit |>
tidy() |>
group_by(.model, term) |>
summarize(across(.cols = c(estimate:`p.value`), .fns = mean)) |>
filter(.model == "arima_enso_log_co2")
arima_cv_fit |>
select(arima_enso_smooth_log) |>
group_by(.model, term) |>
summarize(across(.cols = c(estimate, std.error, statistic, p.value), .fns = mean)) |>
report()
arima_cv_fit |>
select(arima_enso_smooth_log)
arima_cv_fit |>
select(arima_enso_smooth_log)
arima_cv_fit |>
select(arima_enso_smooth_log) |>
ggtime::gg_tsresiduals(plot_type = 'partial')
arima_cv_fc
arima_cv_fc |>
filter(.model == "arima_enso_smooth_log") |>
augment()
arima_cv_fit
arima_cv_fit |>
select(arima_enso_smooth_log) |>
augment()
arima_cv_fit |>
select(arima_enso_smooth_log) |>
augment() |>
ggtime:gg_tsresiduals(
.innov,
plot_type = "partial"
)
arima_cv_fit |>
select(arima_enso_smooth_log) |>
filter(.id == 5) |>
gg_tsresiduals(plot_type = 'partial')
arima_cv_fit |>
augment() |>
filter(.model == "arima_enso_smooth_log") |>
features(.innov, ljung_box, lag = 24)
arima_cv_fc |>
accuracy(arima_valid) |>
select(.model, ME:MAPE) |>
group_by(.model) |>
summarize(across(.cols = c(ME:MAPE), .fns = mean)) |>
arrange(RMSE) |>
kable(digits = 4)
arima_cv_fit |>
augment() |>
filter(.model == "arima_enso_log_co2") |>
features(.innov, ljung_box, lag = 24)
arima_cv_fit |>
select(arima_enso_log_co2) |>
filter(.id == 5)
arima_cv_fit |>
select(arima_enso_log_co2) |>
filter(.id == 5) |>
ggtime::gg_tsresiduals(plot_type = 'partial')
arima_cv_fit |>
augment() |>
filter(.model == "arima_lag_ten_nino") |>
features(.innov, ljung_box, lag = 24)
arima_cv_fit |>
select(arima_lag_ten_nino    ) |>
filter(.id == 5) |>
ggtime::gg_tsresiduals(plot_type = 'partial')
arima_cv_fit |>
select(arima_enso_smooth_log) |>
filter(.id == 5) |>
ggtime::gg_tsresiduals(plot_type = 'partial')
arima_cv_fit |>
tidy() |>
group_by(.model, term) |>
summarize(across(.cols = c(estimate:`p.value`), .fns = mean)) |>
filter(.model == "arima_enso_smooth_log")
arima_cv_fit |>
select(arima_enso_smooth_log)
arima_cv_fit |>
select(arima_enso_log_co2)
arima_cv_fit
arima_report <- arima_cv_fit
left_join
?left_join
?bind_cols
arima_cv_fc |>
accuracy(arima_valid) |>
select(.model, ME:MAPE) |>
group_by(.model) |>
summarize(across(.cols = c(ME:MAPE), .fns = mean)) |>
arrange(RMSE) |>
kable(digits = 4)
arima_cv_fit |>
select(arima_enso_smooth_log)
arima_cv_fit <- arima_trn |>
model(
arima_auto_log = ARIMA(log(actual_temp) ~ co2_ppm + PDQ(D = 1)),
arima_all_log = ARIMA(log(actual_temp) ~ co2_ppm + ch4_ppb + n2o_ppb + TSI + el_nino + la_nina + PDQ(D = 1)),
arima_lag_ten_nino_log = ARIMA(log(actual_temp) ~ co2_lag10 + el_nino + la_nina + PDQ(D = 1)),
arima_enso_log = ARIMA(log(actual_temp) ~ ENSO + PDQ(D = 1)),
arima_enso_smooth_log_lag = ARIMA(log(actual_temp) ~ enso_smooth + co2_lag10 + PDQ(D = 1)),
arima_auto_30 = ARIMA(log(actual_temp) ~ ENSO + co2_lag30 + PDQ(D = 1))
)
arima_cv_fc <- arima_cv_fit |>
forecast(new_data = arima_valid)
arima_cv_fc |>
accuracy(arima_valid) |>
select(.model, ME:MAPE) |>
group_by(.model) |>
summarize(across(.cols = c(ME:MAPE), .fns = mean)) |>
arrange(RMSE) |>
kable(digits = 4)
arima_report |>
full_join(arima_cv_fit, by = ".id")
arima_report <- arima_report |>
full_join(arima_cv_fit, by = ".id")
arima_cv_fc |>
accuracy(arima_valid) |>
select(.model, ME:MAPE) |>
group_by(.model) |>
summarize(across(.cols = c(ME:MAPE), .fns = mean)) |>
arrange(RMSE) |>
kable(digits = 4)
arima_cv_fit |>
select(arima_auto_30)
arima_cv_fit |>
select(arima_auto_30) |>
filter(.id == 5) |>
ggtime::gg_tsresiduals(plot_type = 'partial')
arima_cv_fit |>
select(arima_auto_30) |>
filter(.id == 5) |>
ggtime::gg_tsresiduals()
arima_cv_fit |>
augment() |>
filter(.model == "arima_auto_30") |>
features(.innov, ljung_box, lag = 24)
arima_cv_fit |>
select(arima_all_log) |>
filter(.id == 5) |>
ggtime::gg_tsresiduals()
arima_cv_fit |>
augment() |>
filter(.model == "arima_all_log") |>
features(.innov, ljung_box, lag = 24)
arima_cv_fit <- arima_trn |>
model(
arima_all_log_lag = ARIMA(log(actual_temp) ~ co2_lag10 + n2o_lag10 + ch4_lag10 + PDQ(D = 1)),
arima_all_no_lag = ARIMA(actual_temp ~ co2_ppm + ch4_ppb + n2o_ppb + TSI + el_nino + la_nina + PDQ(D = 1)),
arima_lag_30_nino_log = ARIMA(log(actual_temp) ~ co2_lag30 + el_nino + la_nina + PDQ(D = 1)),
arima_enso_log_mas = ARIMA(log(actual_temp) ~ ENSO + co2_ppm + ch4_ppb + PDQ(D = 1)),
arima_enso_smooth_all = ARIMA(log(actual_temp) ~ enso_smooth + co2_ppm + ch4_ppb + n2o_ppb + TSI + PDQ(D = 1)),
arima_auto_50 = ARIMA(log(actual_temp) ~ ENSO + co2_lag50 + PDQ(D = 1))
)
arima_cv_fc <- arima_cv_fit |>
forecast(new_data = arima_valid)
arima_cv_fc |>
accuracy(arima_valid) |>
select(.model, ME:MAPE) |>
group_by(.model) |>
summarize(across(.cols = c(ME:MAPE), .fns = mean)) |>
arrange(RMSE) |>
kable(digits = 4)
arima_report <- arima_report |>
full_join(arima_cv_fit, by = ".id")
arima_cv_fit |>
tidy() |>
group_by(.model, term) |>
summarize(across(.cols = c(estimate:`p.value`), .fns = mean)) |>
filter(.model == "arima_auto_50")
arima_cv_fit |>
select(arima_auto_50) |>
filter(.id == 5) |>
ggtime::gg_tsresiduals()
arima_cv_fit |>
select(arima_auto_50) |>
filter(.id == 5) |>
ggtime::gg_tsresiduals(plot_type = "partial")
arima_cv_fit |>
augment() |>
filter(.model == "arima_auto_50") |>
features(.innov, ljung_box, lag = 24)
arima_cv_fit |>
select(arima_auto_50)
arima_cv_fit |>
tidy() |>
group_by(.model, term) |>
summarize(across(.cols = c(estimate:`p.value`), .fns = mean)) |>
filter(.model == "arima_enso_smooth_all")
arima_cv_fit |>
select(arima_enso_smooth_all) |>
filter(.id == 5) |>
ggtime::gg_tsresiduals(plot_type = "partial")
arima_cv_fc |>
accuracy(arima_valid) |>
select(.model, ME:MAPE) |>
group_by(.model) |>
summarize(across(.cols = c(ME:MAPE), .fns = mean)) |>
arrange(RMSE) |>
kable(digits = 4)
arima_cv_fit |>
tidy() |>
group_by(.model, term) |>
summarize(across(.cols = c(estimate:`p.value`), .fns = mean)) |>
filter(.model == "arima_enso_log_mas")
arima_cv_fc |>
accuracy(arima_valid) |>
select(.model, ME:MAPE) |>
group_by(.model) |>
summarize(across(.cols = c(ME:MAPE), .fns = mean)) |>
arrange(RMSE) |>
kable(digits = 4)
arima_cv_fit |>
select(arima_lag_30_nino_log) |>
filter(.id == 5) |>
ggtime::gg_tsresiduals(plot_type = "partial")
arima_cv_fc |>
accuracy(arima_valid) |>
select(.model, ME:MAPE) |>
group_by(.model) |>
summarize(across(.cols = c(ME:MAPE), .fns = mean)) |>
arrange(RMSE) |>
kable(digits = 4)
arima_cv_fit |>
tidy() |>
group_by(.model, term) |>
summarize(across(.cols = c(estimate:`p.value`), .fns = mean)) |>
filter(.model == "arima_all_no_lag")
arima_cv_fit |>
select(arima_all_no_lag) |>
filter(.id == 5) |>
ggtime::gg_tsresiduals(plot_type = "partial")
arima_cv_fit |>
select(arima_all_no_lag)
arima_cv_fit |>
tidy() |>
group_by(.model, term) |>
summarize(across(.cols = c(estimate:`p.value`), .fns = mean)) |>
filter(.model == "arima_all_no_lag")
colnames(arima_report)
arima_cv_fit <- arima_trn |>
model(
arima_all_no_lag_custom = ARIMA(actual_temp ~ co2_ppm + ch4_ppb + n2o_ppb + TSI + el_nino + la_nina + pdq(1, 0, 0) + PDQ(1, 1, 0)),
arima_lag_30_nino_log = ARIMA(log(actual_temp) ~ co2_lag30 + el_nino + la_nina + PDQ(D = 1)),
arima_enso_mas = ARIMA(actual_temp ~ ENSO + co2_ppm + ch4_ppb + PDQ(D = 1)),
arima_enso_smooth_some = ARIMA(actual_temp ~ enso_smooth + co2_ppm + n2o_ppb + PDQ(D = 1)),
arima_auto_50 = ARIMA(log(actual_temp) ~ enso_smooth + co2_lag50 + PDQ(D = 1))
)
arima_cv_fc <- arima_cv_fit |>
forecast(new_data = arima_valid)
arima_cv_fc |>
accuracy(arima_valid) |>
select(.model, ME:MAPE) |>
group_by(.model) |>
summarize(across(.cols = c(ME:MAPE), .fns = mean)) |>
arrange(RMSE) |>
kable(digits = 4)
arima_cv_fit |>
select(arima_enso_smooth_some) |>
report()
arima_cv_fit |>
tidy() |>
group_by(.model, term) |>
summarize(across(.cols = c(estimate:`p.value`), .fns = mean)) |>
filter(.model == "arima_enso_smooth_some")
arima_cv_fit |>
select(arima_enso_smooth_some) |>
filter(.id == 5) |>
ggtime::gg_tsresiduals(plot_type = "partial")
arima_cv_fit |>
select(arima_enso_smooth_some)
arima_cv_fc |>
accuracy(arima_valid) |>
select(.model, ME:MAPE) |>
group_by(.model) |>
summarize(across(.cols = c(ME:MAPE), .fns = mean)) |>
arrange(RMSE) |>
kable(digits = 4)
arima_report <- arima_report |>
full_join(arima_cv_fit, by = ".id")
arima_cv_fit |>
select(arima_auto_50) |>
filter(.id == 5) |>
ggtime::gg_tsresiduals(plot_type = "partial")
arima_cv_fit |>
augment() |>
filter(.model == "arima_auto_50") |>
features(.innov, ljung_box, lag = 24)
arima_cv_fc |>
accuracy(arima_valid) |>
select(.model, ME:MAPE) |>
group_by(.model) |>
summarize(across(.cols = c(ME:MAPE), .fns = mean)) |>
arrange(RMSE) |>
kable(digits = 4)
arima_cv_fit |>
select(arima_enso_smooth_some)
arima_cv_fit <- arima_trn |>
model(
arima_auto_co2 = ARIMA(actual_temp ~ co2_ppm + PDQ(D = 1)),
arima_box_auto = ARIMA(box_cox(actual_temp, lambda = 1.5) ~ co2_ppm + PDQ(D = 1)),
arima_all_no_log = ARIMA(actual_temp ~ co2_ppm + ch4_ppb + n2o_ppb + TSI + el_nino + la_nina + PDQ(D = 1)),
arima_lag_ten_nino_no_log = ARIMA(actual_temp ~ co2_lag10 + el_nino + la_nina + PDQ(D = 1)),
arima_lag_50_nino_no_long = ARIMA(actual_temp ~ co2_lag50 + el_nino + la_nina + PDQ(D = 1))
)
arima_cv_fc <- arima_cv_fit |>
forecast(new_data = arima_valid)
arima_cv_fc |>
accuracy(arima_valid) |>
select(.model, ME:MAPE) |>
group_by(.model) |>
summarize(across(.cols = c(ME:MAPE), .fns = mean)) |>
arrange(RMSE) |>
kable(digits = 4)
arima_report <- arima_report |>
full_join(arima_cv_fit, by = ".id")
write_rds(arima_report, "data/arima_models.rds")
?slider::slide2_dbl
