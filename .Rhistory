report()
ppm_fit |>
filter(.id == 11) |>
select(arima_smoothed) |>
report()
ppm_fit |>
tidy() |>
group_by(.model, term) |>
summarize(across(.cols = c(estimate:`p.value`), .fns = mean)) |>
filter(.model == "arima_smoothed")
ppm_fit <- cv_trn |>
model(
arima_auto = ARIMA(co2_ppm ~ aggregate_emissions + ENSO, greedy = FALSE),
arima_smoothed = ARIMA(co2_ppm ~ aggregate_emissions + lag(enso_smooth, 1) + PDQ(D = 1), greedy = FALSE)
)
ppm_fit |>
accuracy() |>
group_by(.model) |>
summarize(across(.cols = c(ME:MAPE), .fns = mean)) |>
arrange(RMSE)
ppm_fit |>
filter(.id == 11) |>
select(arima_smoothed) |>
report()
ppm_fit |>
tidy() |>
group_by(.model, term) |>
summarize(across(.cols = c(estimate:`p.value`), .fns = mean)) |>
filter(.model == "arima_smoothed")
ppm_fc <- ppm_fit |>
forecast(cv_valid)
ppm_fc |>
accuracy(cv_valid) |>
group_by(.model) |>
summarize(across(.cols = c(ME:MAPE), .fns = mean)) |>
arrange(RMSE)
ppm_fc |>
filter(.id %in% c(10, 11)) |>
autoplot() +
autolayer(ppm_model |> filter(year(Date) >= 2010), co2_ppm) +
facet_wrap(~ .model, ncol = 1) +
theme_minimal()
ppm_fit |>
tidy() |>
group_by(.model, term) |>
summarize(across(.cols = c(estimate:`p.value`), .fns = mean)) |>
filter(.model == "arima_auto")
ppm_fit <- cv_trn |>
model(
arima_auto = ARIMA(co2_ppm ~ aggregate_emissions + ENSO, greedy = FALSE),
arima_smoothed = ARIMA(co2_ppm ~ aggregate_emissions + enso_smooth, greedy = FALSE)
)
ppm_fit |>
accuracy() |>
group_by(.model) |>
summarize(across(.cols = c(ME:MAPE), .fns = mean)) |>
arrange(RMSE)
ppm_fit |>
filter(.id == 11) |>
select(arima_smoothed) |>
report()
ppm_fit |>
tidy() |>
group_by(.model, term) |>
summarize(across(.cols = c(estimate:`p.value`), .fns = mean)) |>
filter(.model == "arima_auto")
ppm_fit |>
filter(.id == 11) |>
select(arima_auto) |>
report()
ppm_fit |>
filter(.id == 11) |>
select(arima_smoothed) |>
report()
ppm_fit |>
tidy() |>
group_by(.model, term) |>
summarize(across(.cols = c(estimate:`p.value`), .fns = mean)) |>
filter(.model == "arima_smoothed")
ppm_fc <- ppm_fit |>
forecast(cv_valid)
ppm_fc |>
accuracy(cv_valid) |>
group_by(.model) |>
summarize(across(.cols = c(ME:MAPE), .fns = mean)) |>
arrange(RMSE)
ppm_fc |>
filter(.id %in% c(10, 11)) |>
autoplot() +
autolayer(ppm_model |> filter(year(Date) >= 2010), co2_ppm) +
facet_wrap(~ .model, ncol = 1) +
theme_minimal()
ppm_fit |>
filter(.id == 11) |>
select(arima_auto) |>
gg_tsresiduals(plot_type = 'partial')
ppm_fit |>
filter(.id == 11) |>
select(arima_smoothed) |>
gg_tsresiduals(plot_type = 'partial')
ppm_nino |>
filter(year(Date) > 1957) |>
dim()
cv_agg <- ppm_nino |>
filter(year(Date) > 1957) |>
stretch_tsibble(.init = 444, .step = 36)
cv_trn <- cv_agg |>
group_by(.id) |>
slice(1:(n() - 36)) |>
ungroup()
cv_valid <- cv_agg |>
group_by(.id) |>
slice_tail(n = 36) |>
ungroup()
ppm_fit <- cv_trn |>
model(
arima_auto = ARIMA(co2_ppm ~ aggregate_emissions + ENSO, greedy = FALSE),
arima_smoothed = ARIMA(co2_ppm ~ aggregate_emissions + enso_smooth, greedy = FALSE)
)
ppm_fit |>
accuracy() |>
group_by(.model) |>
summarize(across(.cols = c(ME:MAPE), .fns = mean)) |>
arrange(RMSE)
ppm_fit |>
filter(.id == 11) |>
select(arima_smoothed) |>
report()
ppm_fit |>
tidy() |>
group_by(.model, term) |>
summarize(across(.cols = c(estimate:`p.value`), .fns = mean)) |>
filter(.model == "arima_smoothed")
ppm_fc <- ppm_fit |>
forecast(cv_valid)
ppm_fc |>
accuracy(cv_valid) |>
group_by(.model) |>
summarize(across(.cols = c(ME:MAPE), .fns = mean)) |>
arrange(RMSE)
ppm_fit |>
tidy() |>
group_by(.model, term) |>
summarize(across(.cols = c(estimate:`p.value`), .fns = mean)) |>
filter(.model == "arima_auto")
ppm_fit |>
filter(.id == 11) |>
select(arima_smoothed) |>
report()
ppm_fit |>
filter(.id == 11) |>
select(arima_auto) |>
report()
ppm_fit <- cv_trn |>
model(
arima_auto = ARIMA(co2_ppm ~ aggregate_emissions + ENSO, greedy = FALSE),
arima_smoothed = ARIMA(co2_ppm ~ aggregate_emissions + enso_smooth + PDQ(0, 1, 1) + pdq(d = 1), greedy = FALSE)
)
ppm_fit |>
accuracy() |>
group_by(.model) |>
summarize(across(.cols = c(ME:MAPE), .fns = mean)) |>
arrange(RMSE)
ppm_fit |>
filter(.id == 11) |>
select(arima_auto) |>
report()
ppm_fit |>
tidy() |>
group_by(.model, term) |>
summarize(across(.cols = c(estimate:`p.value`), .fns = mean)) |>
filter(.model == "arima_smoothed")
ppm_fc <- ppm_fit |>
forecast(cv_valid)
ppm_fc |>
accuracy(cv_valid) |>
group_by(.model) |>
summarize(across(.cols = c(ME:MAPE), .fns = mean)) |>
arrange(RMSE)
ppm_fit |>
filter(.id == 11) |>
select(arima_smoothed) |>
gg_tsresiduals(plot_type = 'partial')
ppm_fit |>
filter(.id == 11) |>
select(arima_auto) |>
gg_tsresiduals(plot_type = 'partial')
ppm_fit |>
tidy() |>
group_by(.model, term) |>
summarize(across(.cols = c(estimate:`p.value`), .fns = mean)) |>
filter(.model == "arima_auto")
ppm_fit |>
filter(.id == 11) |>
select(arima_auto) |>
report()
ppm_fit |>
filter(.id == 11) |>
select(arima_smmothed) |>
report()
ppm_fit |>
filter(.id == 11) |>
select(arima_smoothed) |>
report()
ppm_fit |>
tidy()
ppm_fit
ppm_fit <- cv_trn |>
model(
arima_auto = ARIMA(co2_ppm ~ aggregate_emissions + ENSO + pdq(1, 0, 1) + PDQ(2, 1, 2), greedy = FALSE),
arima_smoothed = ARIMA(co2_ppm ~ aggregate_emissions + enso_smooth + PDQ(0, 1, 1) + pdq(2, 1, 2), greedy = FALSE)
)
ppm_fit <- cv_trn |>
model(
arima_auto = ARIMA(co2_ppm ~ 1 + aggregate_emissions + ENSO + pdq(1, 0, 1) + PDQ(2, 1, 2), greedy = FALSE),
arima_smoothed = ARIMA(co2_ppm ~ 1 + aggregate_emissions + enso_smooth + PDQ(0, 1, 1) + pdq(2, 1, 2), greedy = FALSE)
)
ppm_fit |>
accuracy() |>
group_by(.model) |>
summarize(across(.cols = c(ME:MAPE), .fns = mean)) |>
arrange(RMSE)
ppm_fit |>
filter(.id == 11) |>
select(arima_smoothed) |>
report()
ppm_fit |>
tidy() |>
group_by(.model, term) |>
summarize(across(.cols = c(estimate:`p.value`), .fns = mean)) |>
filter(.model == "arima_auto")
ppm_fit |>
tidy() |>
group_by(.model, term) |>
summarize(across(.cols = c(estimate:`p.value`), .fns = mean)) |>
filter(.model == "arima_smoothed")
ppm_fc <- ppm_fit |>
forecast(cv_valid)
ppm_fc |>
accuracy(cv_valid) |>
group_by(.model) |>
summarize(across(.cols = c(ME:MAPE), .fns = mean)) |>
arrange(RMSE)
ppm_fit <- cv_trn |>
model(
arima_auto = ARIMA(co2_ppm ~ 1 + aggregate_emissions + ENSO + pdq(1, 0, 1) + PDQ(2, 1, 2), greedy = FALSE),
arima_smoothed = ARIMA(co2_ppm ~ 0 + aggregate_emissions + enso_smooth + PDQ(0, 1, 1) + pdq(2, 1, 2), greedy = FALSE)
)
ppm_fit |>
accuracy() |>
group_by(.model) |>
summarize(across(.cols = c(ME:MAPE), .fns = mean)) |>
arrange(RMSE)
ppm_fit |>
filter(.id == 11) |>
select(arima_smoothed) |>
report()
ppm_fit |>
tidy() |>
group_by(.model, term) |>
summarize(across(.cols = c(estimate:`p.value`), .fns = mean)) |>
filter(.model == "arima_smoothed")
ppm_fc |>
accuracy(cv_valid) |>
group_by(.model) |>
summarize(across(.cols = c(ME:MAPE), .fns = mean)) |>
arrange(RMSE)
ppm_fc |>
filter(.id %in% c(10, 11)) |>
autoplot() +
autolayer(ppm_model |> filter(year(Date) >= 2010), co2_ppm) +
facet_wrap(~ .model, ncol = 1) +
theme_minimal()
ppm_fit |>
filter(.id == 11) |>
select(arima_auto) |>
report()
ppm_fit |>
filter(.id == 11) |>
select(arima_auto) |>
gg_tsresiduals(plot_type = 'partial')
ppm_fit |>
filter(.id == 11) |>
select(arima_smoothed) |>
gg_tsresiduals(plot_type = 'partial')
ppm_fit <- cv_trn |>
model(
arima_smoothed = ARIMA(co2_ppm ~ 0 + aggregate_emissions + enso_smooth + PDQ(0, 1, 1) + pdq(1, 1, 1), greedy = FALSE)
)
ppm_fit |>
accuracy() |>
group_by(.model) |>
summarize(across(.cols = c(ME:MAPE), .fns = mean)) |>
arrange(RMSE)
ppm_fit |>
filter(.id == 11) |>
select(arima_auto) |>
report()
ppm_fit |>
filter(.id == 11) |>
select(arima_smoothed) |>
report()
ppm_fit |>
tidy() |>
group_by(.model, term) |>
summarize(across(.cols = c(estimate:`p.value`), .fns = mean)) |>
filter(.model == "arima_smoothed")
ppm_fc <- ppm_fit |>
forecast(cv_valid)
ppm_fc |>
accuracy(cv_valid) |>
group_by(.model) |>
summarize(across(.cols = c(ME:MAPE), .fns = mean)) |>
arrange(RMSE)
ppm_fc |>
filter(.id %in% c(10, 11)) |>
autoplot() +
autolayer(ppm_model |> filter(year(Date) >= 2010), co2_ppm) +
facet_wrap(~ .model, ncol = 1) +
theme_minimal()
ppm_fit <- cv_trn |>
model(
arima_smoothed = ARIMA(co2_ppm ~ 0 + aggregate_emissions + enso_smooth + PDQ(0, 1, 1) + pdq(1, 1, 2), greedy = FALSE)
)
ppm_fit |>
tidy() |>
group_by(.model, term) |>
summarize(across(.cols = c(estimate:`p.value`), .fns = mean)) |>
filter(.model == "arima_smoothed")
ppm_fit <- cv_trn |>
model(
arima_smoothed = ARIMA(co2_ppm ~ 0 + aggregate_emissions + enso_smooth + PDQ(0, 1, 2) + pdq(1, 1, 1), greedy = FALSE)
)
ppm_fit |>
tidy() |>
group_by(.model, term) |>
summarize(across(.cols = c(estimate:`p.value`), .fns = mean)) |>
filter(.model == "arima_smoothed")
ppm_fc <- ppm_fit |>
forecast(cv_valid)
ppm_fc |>
accuracy(cv_valid) |>
group_by(.model) |>
summarize(across(.cols = c(ME:MAPE), .fns = mean)) |>
arrange(RMSE)
ppm_fc |>
filter(.id %in% c(10, 11)) |>
autoplot() +
autolayer(ppm_model |> filter(year(Date) >= 2010), co2_ppm) +
facet_wrap(~ .model, ncol = 1) +
theme_minimal()
ppm_fit |>
filter(.id == 11) |>
select(arima_smoothed) |>
gg_tsresiduals(plot_type = 'partial')
ppm_fit <- cv_trn |>
model(
arima_smoothed = ARIMA(co2_ppm ~ 0 + aggregate_emissions + enso_smooth + PDQ(1, 1, 1) + pdq(1, 1, 1), greedy = FALSE)
)
ppm_fit |>
tidy() |>
group_by(.model, term) |>
summarize(across(.cols = c(estimate:`p.value`), .fns = mean)) |>
filter(.model == "arima_smoothed")
ppm_fc <- ppm_fit |>
forecast(cv_valid)
ppm_fc |>
accuracy(cv_valid) |>
group_by(.model) |>
summarize(across(.cols = c(ME:MAPE), .fns = mean)) |>
arrange(RMSE)
ppm_fc |>
filter(.id %in% c(10, 11)) |>
autoplot() +
autolayer(ppm_model |> filter(year(Date) >= 2010), co2_ppm) +
facet_wrap(~ .model, ncol = 1) +
theme_minimal()
ppm_fit |>
filter(.id == 11) |>
select(arima_smoothed) |>
gg_tsresiduals(plot_type = 'partial')
ppm_fit <- cv_trn |>
model(
arima_smoothed = ARIMA(co2_ppm ~ 0 + aggregate_emissions + enso_smooth + PDQ(0, 1, 1) + pdq(1, 1, 1), greedy = FALSE)
)
ppm_fit |>
filter(.id == 11) |>
select(arima_smoothed) |>
gg_tsresiduals(plot_type = 'partial')
ppm_fit <- cv_trn |>
model(
arima_smoothed = ARIMA(co2_ppm ~ 1 + aggregate_emissions + enso_smooth + PDQ(0, 1, 1) + pdq(1, 1, 1), greedy = FALSE)
)
ppm_fit |>
tidy() |>
group_by(.model, term) |>
summarize(across(.cols = c(estimate:`p.value`), .fns = mean)) |>
filter(.model == "arima_smoothed")
ppm_fit |>
filter(.id == 11) |>
select(arima_smoothed) |>
report()
ppm_fc <- ppm_fit |>
forecast(cv_valid)
ppm_fc |>
accuracy(cv_valid) |>
group_by(.model) |>
summarize(across(.cols = c(ME:MAPE), .fns = mean)) |>
arrange(RMSE)
trn_data <- ppm_nino |>
filter(year(Date) > 1957) |>
slice(1:(n() - 36))
valid_data <- ppm_nino |>
filter(year(Date) > 1957) |>
slice_tail(n = 36)
best_arima <- trn_data |>
model(
arima_smoothed = ARIMA(co2_ppm ~ 0 + aggregate_emissions + enso_smooth + PDQ(0, 1, 1) + pdq(1, 1, 1), greedy = FALSE)
)
best_arima |>
accuracy()
best_arima_fc <- best_arima |>
forecast(new_data = valid_data)
best_arima_fc |>
accuracy(valid_data)
best_arima_fc |>
gg_tsresiduals(plot_type = 'partial')
best_arima_fc
best_arima_fc |>
gg_tsresiduals(co2_ppm, plot_type = 'partial')
best_arima |>
gg_tsresiduals(plot_type = 'partial')
best_arima_fc |>
autoplot() +
autolayer(ppm_nin0 |> filter(year(Date) >= 2010), co2_ppm) +
theme_minimal()
best_arima_fc |>
autoplot() +
autolayer(ppm_nino |> filter(year(Date) >= 2010), co2_ppm) +
theme_minimal()
best_arima <- trn_data |>
model(
arima = ARIMA(co2_ppm, greedy = FALSE)
)
best_arima_fc <- best_arima |>
forecast(new_data = valid_data)
best_arima_fc |>
accuracy(valid_data)
best_arima |>
gg_tsresiduals(plot_type = 'partial')
best_arima_fc |>
autoplot() +
autolayer(ppm_nino |> filter(year(Date) >= 2010), co2_ppm) +
theme_minimal()
best_arima <- trn_data |>
model(
arima = ARIMA(co2_ppm ~ aggregate_emissions, greedy = FALSE)
)
best_arima_fc <- best_arima |>
forecast(new_data = valid_data)
best_arima_fc |>
accuracy(valid_data)
best_arima |>
gg_tsresiduals(plot_type = 'partial')
best_arima_fc |>
autoplot() +
autolayer(ppm_nino |> filter(year(Date) >= 2010), co2_ppm) +
theme_minimal()
best_arima |> report()
best_arima |> tidy()
best_arima <- trn_data |>
model(
arima = ARIMA(co2_ppm, greedy = FALSE)
)
best_arima |> report()
best_arima |> tidy()
best_arima <- trn_data |>
model(
arima = ARIMA(co2_ppm ~ aggregate_emissions + pdq(d = 1), greedy = FALSE)
)
best_arima |> report()
best_arima |> tidy()
best_arima_fc <- best_arima |>
forecast(new_data = valid_data)
best_arima_fc |>
accuracy(valid_data)
best_arima |>
gg_tsresiduals(plot_type = 'partial')
best_arima_fc |>
autoplot() +
autolayer(ppm_nino |> filter(year(Date) >= 2010), co2_ppm) +
theme_minimal()
best_arima |> report()
best_arima <- trn_data |>
model(
arima = ARIMA(co2_ppm ~ aggregate_emissions + enso_smooth + pdq(d = 1), greedy = FALSE)
)
best_arima |> report()
best_arima |> tidy()
best_arima <- trn_data |>
model(
arima_smoothed = ARIMA(co2_ppm ~ 0 + aggregate_emissions + enso_smooth + PDQ(0, 1, 1) + pdq(1, 1, 1), greedy = FALSE)
)
best_arima |> report()
best_arima |> tidy()
best_arima_fc <- best_arima |>
forecast(new_data = valid_data)
best_arima_fc |>
accuracy(valid_data)
ppm_nino
write_rds(ppm_nino, "data/enso_index.rds")
write_rds(ppm_nino, "data/agg_emissions_enso_index.rds")
